import{a as e,j as t}from"./index.BEKffTCe.js";import{r as a}from"./vendor.D19QI8Si.js";import{m as r}from"./animation.CbnW-eHj.js";import{T as i,m as s,Z as o}from"./icons.B27eQM06.js";import{R as l,A as d,C as n,X as c,Y as x,T as m,a as h,b}from"./charts.rQK6pzHo.js";const g=()=>navigator.vibrate&&navigator.vibrate(10),p=()=>navigator.vibrate&&navigator.vibrate(20),w=a.memo(({isBgDark:e})=>t.jsxs("div",{className:"min-h-screen pt-16 pb-32 px-3 md:px-4 flex flex-col "+(e?"bg-black":"bg-[#f2f2f7]"),children:[t.jsxs(r.div,{animate:{opacity:[.5,.8,.5]},transition:{duration:1.5,repeat:1/0},className:"mb-8",children:[t.jsx("div",{className:"h-8 md:h-12 rounded-2xl mb-2 "+(e?"bg-white/10":"bg-white/40")}),t.jsx("div",{className:"h-4 md:h-6 rounded-2xl w-2/3 "+(e?"bg-white/10":"bg-white/40")})]}),t.jsx(r.div,{animate:{opacity:[.5,.8,.5]},transition:{duration:1.5,repeat:1/0,delay:.1},className:"rounded-[32px] p-6 mb-8 h-40 md:h-48 "+(e?"bg-white/5":"bg-white/40")}),t.jsx(r.div,{animate:{opacity:[.5,.8,.5]},transition:{duration:1.5,repeat:1/0,delay:.2},children:t.jsx("div",{className:"flex gap-2 mb-8",children:[1,2,3,4].map(a=>t.jsx("div",{className:"flex-1 h-10 md:h-12 rounded-xl "+(e?"bg-white/10":"bg-white/40")},a))})}),t.jsx(r.div,{animate:{opacity:[.5,.8,.5]},transition:{duration:1.5,repeat:1/0,delay:.3},className:"rounded-[32px] mb-8 h-64 md:h-96 "+(e?"bg-white/5":"bg-white/40")}),t.jsx(r.div,{animate:{opacity:[.5,.8,.5]},transition:{duration:1.5,repeat:1/0,delay:.4},className:"rounded-[32px] p-6 h-48 md:h-64 "+(e?"bg-white/5":"bg-white/40")})]}));w.displayName="SkeletonLoader";const u=a.memo(({riskLevel:e,lastVal:a,isBgDark:i})=>t.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},onMouseEnter:()=>g(),onClick:()=>navigator.vibrate&&navigator.vibrate([30,20,30]),className:`relative mb-8 rounded-[32px] p-6 md:p-8 backdrop-blur-2xl border cursor-pointer active:scale-95 transition-transform ${i?"bg-white/5 border-white/10":"bg-white/40 border-white/60"} ${e.glow} overflow-hidden`,children:[t.jsx("div",{className:`absolute -inset-1 rounded-[32px] bg-gradient-to-br ${e.color} opacity-20 blur-3xl -z-10`}),t.jsxs("div",{className:"flex items-end justify-between relative z-10",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs md:text-sm font-bold uppercase opacity-60 mb-2 "+(i?"text-gray-400":"text-gray-600"),children:"–¢–µ–∫—É—â–∏–π —Ä–∏—Å–∫-–∏–Ω–¥–µ–∫—Å"}),t.jsx(r.p,{initial:{scale:1.2,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.4},className:"text-4xl md:text-6xl font-black font-mono tracking-tighter mb-3",children:a},a),t.jsx("div",{className:`inline-block px-3 md:px-4 py-1 md:py-2 rounded-full text-xs md:text-sm font-bold ${e.color} bg-gradient-to-r text-white shadow-lg`,children:e.label})]}),t.jsx(r.div,{animate:{rotate:[0,10,-10,0]},transition:{duration:3,repeat:1/0},className:`w-20 h-20 md:w-28 md:h-28 rounded-2xl bg-gradient-to-br ${e.color} p-px shadow-2xl flex-shrink-0`,children:t.jsx("div",{className:`w-full h-full rounded-2xl ${i?"bg-black":"bg-white"} flex items-center justify-center`,children:t.jsx(r.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:t.jsx(o,{size:40,className:`${e.textColor} md:w-14 md:h-14`})})})})]})]}),(e,t)=>e.lastVal===t.lastVal&&e.isBgDark===t.isBgDark&&e.riskLevel.label===t.riskLevel.label);u.displayName="RiskCard";const y=a.memo(({timeframe:e,onChange:a,isBgDark:i})=>t.jsx("div",{className:"flex gap-2 mb-8 p-2 rounded-2xl backdrop-blur-xl border "+(i?"bg-white/5 border-white/10":"bg-white/40 border-white/60"),children:[7,30,90,180].map(s=>t.jsx(r.button,{whileTap:{scale:.92},onMouseDown:()=>g(),onClick:()=>{p(),a(s)},className:"flex-1 py-2 md:py-3 rounded-xl text-[10px] md:text-[11px] font-bold transition-all duration-300 cursor-pointer active:scale-95 "+(e===s?"bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow-lg shadow-blue-500/50":(i?"text-gray-400 hover:text-white":"text-gray-700 hover:text-black")+" hover:bg-white/10"),children:180===s?"ALL":`${s}D`},s))}),(e,t)=>e.timeframe===t.timeframe&&e.isBgDark===t.isBgDark);y.displayName="TimeframeButtons";const f=a.memo(({item:e,index:i,getRiskColor:s})=>{const o=a.useMemo(()=>s(e.risk),[e.risk,s]);return t.jsx(r.div,{initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{delay:.35+.05*i},whileHover:{scale:1.02,translateY:-2},whileTap:{scale:.98},onMouseEnter:()=>g(),onClick:()=>p(),className:`rounded-2xl p-3 md:p-4 backdrop-blur-xl border bg-gradient-to-br cursor-pointer active:scale-95 transition-all ${o.bg} ${o.border} ${o.shadow}`,children:t.jsxs("div",{className:"flex items-center gap-3 md:gap-4",children:[t.jsxs("div",{className:"text-center min-w-[60px] md:min-w-[70px] p-2 md:p-3 rounded-xl bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-md border border-white/20",children:[t.jsx("div",{className:`text-2xl md:text-3xl mb-1 ${o.textClass}`,children:e.risk>=8?"‚ö†Ô∏è":e.risk>=5?"üìä":"‚úÖ"}),t.jsx("p",{className:"text-xs md:text-sm font-black",children:e.day}),t.jsx("p",{className:"text-[10px] opacity-60 mt-1",children:e.label})]}),t.jsxs("div",{className:"flex-1 space-y-1 md:space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:`text-[10px] md:text-xs font-bold ${o.textClass}`,children:"–†–ò–°–ö"}),t.jsxs("span",{className:`text-base md:text-lg font-black font-mono ${o.textClass}`,children:[e.risk,"%"]})]}),t.jsx("div",{className:"h-5 md:h-6 rounded-full relative overflow-hidden bg-white/10 border border-white/20",children:t.jsx(r.div,{initial:{width:0},animate:{width:`${e.risk}%`},transition:{delay:.4+.08*i,duration:.8,ease:"easeOut"},className:`h-full rounded-full ${o.bar} shadow-lg`,style:{filter:`drop-shadow(0 0 12px ${"bg-red-500"===o.bar?"rgba(239,68,68,0.7)":"bg-orange-500"===o.bar?"rgba(249,115,22,0.7)":"bg-yellow-500"===o.bar?"rgba(234,179,8,0.5)":"rgba(34,197,94,0.5)"})`}})})]})]})})},(e,t)=>e.item.day===t.item.day&&e.item.risk===t.item.risk&&e.index===t.index);f.displayName="ForecastCard";const v=a.memo(({viewData:e,isBgDark:i})=>{const s=a.useRef(null),[o,g]=a.useState(null),p=a.useMemo(()=>((e,t=60)=>{if(e.length<=t)return e;const a=Math.ceil(e.length/t),r=[];for(let i=0;i<e.length;i+=a){const t=e.slice(i,i+a),s=t.reduce((e,t)=>e+(Number(t.value)||0),0)/t.length;r.push({...t[Math.floor(t.length/2)],value:Number(s.toFixed(2))})}return r})(e,"undefined"!=typeof window&&window.innerWidth<768?40:60),[e]);return t.jsxs(r.div,{ref:s,onTouchStart:e=>{g(e.touches?.[0]?.clientX)},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"rounded-[36px] backdrop-blur-3xl border shadow-2xl relative overflow-hidden mb-8 "+(i?"bg-gradient-to-br from-white/8 via-white/5 to-white/3 border-white/15":"bg-gradient-to-br from-white/70 via-white/60 to-white/50 border-white/40"),children:[t.jsxs("div",{className:"absolute inset-0 opacity-20 pointer-events-none rounded-[36px]",children:[t.jsx("div",{className:"absolute top-0 right-0 w-72 h-72 rounded-full blur-3xl bg-gradient-to-l from-blue-500 to-cyan-400 opacity-40"}),t.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 rounded-full blur-3xl bg-gradient-to-r from-blue-600 via-purple-500 to-pink-500 opacity-20"})]}),t.jsxs("div",{className:"relative z-10 p-4 md:p-8",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-xl md:text-3xl font-black mb-2 "+(i?"text-white":"text-black"),children:"–ò–Ω–¥–µ–∫—Å –†–∏—Å–∫–∞"}),t.jsx("p",{className:"text-xs md:text-base "+(i?"text-gray-400":"text-gray-600"),children:"–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥"})]}),t.jsx(l,{width:"100%",height:window.innerWidth<768?280:480,children:t.jsxs(d,{data:p,margin:{top:10,right:15,bottom:20,left:0},children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"gradientFill",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"0%",stopColor:"#3B82F6",stopOpacity:.6}),t.jsx("stop",{offset:"50%",stopColor:"#06B6D4",stopOpacity:.3}),t.jsx("stop",{offset:"100%",stopColor:"#3B82F6",stopOpacity:.05})]}),t.jsxs("filter",{id:"chartGlow",children:[t.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),t.jsx(n,{strokeDasharray:"0",stroke:i?"rgba(255,255,255,0.06)":"rgba(0,0,0,0.06)",vertical:!1}),t.jsx(c,{dataKey:"date",tick:{fill:i?"#9CA3AF":"#6B7280",fontSize:12,fontWeight:500},tickLine:!1,axisLine:!1,formatter:e=>{try{return new Date(e).toLocaleDateString("ru-RU",{month:"short",day:"numeric"})}catch(t){return e}}}),t.jsx(x,{tick:{fill:i?"#9CA3AF":"#6B7280",fontSize:12,fontWeight:500},tickLine:!1,axisLine:!1,domain:[0,10],tickFormatter:e=>e.toFixed(0)}),t.jsx(m,{contentStyle:{background:i?"rgba(0,0,0,0.92)":"rgba(255,255,255,0.95)",border:"1.5px solid #3B82F6",borderRadius:"24px",boxShadow:i?"0 20px 60px rgba(59,130,246,0.4), 0 0 40px rgba(59,130,246,0.2)":"0 20px 60px rgba(59,130,246,0.25), 0 0 40px rgba(59,130,246,0.15)",backdropFilter:"blur(30px)",padding:"16px 20px",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif'},itemStyle:{color:"#3B82F6",fontWeight:"600",fontSize:"14px"},labelStyle:{color:i?"#64b5f6":"#2196f3",fontSize:"13px",fontWeight:"650"},formatter:e=>[e.toFixed(2),"üìä"],labelFormatter:e=>{try{return new Date(e).toLocaleDateString("ru-RU",{weekday:"short",month:"short",day:"numeric"})}catch(t){return e}},cursor:{stroke:"#3B82F6",strokeWidth:1.5,opacity:.5}}),t.jsx(h,{y:4,stroke:"#eab308",strokeDasharray:"8 4",opacity:.25}),t.jsx(h,{y:7,stroke:"#f97316",strokeDasharray:"8 4",opacity:.25}),t.jsx(b,{type:"natural",dataKey:"value",stroke:"#3B82F6",strokeWidth:3.5,fill:"url(#gradientFill)",animationDuration:300,isAnimationActive:!0,filter:"url(#chartGlow)",dot:e=>{const{cx:a,cy:r,value:i}=e;return t.jsx("circle",{cx:a,cy:r,r:2.5,fill:"#3B82F6",stroke:"#fff",strokeWidth:2,opacity:.7})},activeDot:{r:5.5,fill:"#3B82F6",stroke:"#fff",strokeWidth:2.5,filter:"drop-shadow(0 0 15px rgba(59,130,246,0.6))"}})]})}),t.jsxs(r.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"mt-6 p-4 rounded-2xl flex items-center gap-3 "+(i?"bg-white/8 border border-white/10":"bg-black/5 border border-black/10"),children:[t.jsx("div",{className:"w-2.5 h-2.5 rounded-full "+(i?"bg-blue-400":"bg-blue-500")}),t.jsxs("span",{className:"text-sm font-medium "+(i?"text-gray-300":"text-gray-700"),children:["–í—Å–µ–≥–æ —Ç–æ—á–µ–∫: ",t.jsx("span",{className:"font-bold",children:p.length})," ‚Ä¢ –û–±–Ω–æ–≤–ª–µ–Ω–æ: ",t.jsx("span",{className:"font-bold",children:(new Date).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})})]})]})]})]})},(e,t)=>e.isBgDark===t.isBgDark&&e.viewData.length===t.viewData.length&&e.viewData[e.viewData.length-1]?.value===t.viewData[t.viewData.length-1]?.value);v.displayName="ChartComponent";const j=({theme:o="dark"})=>{const[l,d]=a.useState([]),[n,c]=a.useState([]),[x,m]=a.useState(30),[h,b]=a.useState(!0),[g,p]=a.useState([{day:"–ü–ù",risk:45,label:"–ù–∏–∑–∫–∏–π"},{day:"–í–¢",risk:62,label:"–°—Ä–µ–¥–Ω–∏–π"},{day:"–°–†",risk:78,label:"–í—ã—Å–æ–∫–∏–π"},{day:"–ß–¢",risk:85,label:"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π"},{day:"–ü–¢",risk:55,label:"–°—Ä–µ–¥–Ω–∏–π"},{day:"–°–ë",risk:30,label:"–ù–∏–∑–∫–∏–π"},{day:"–í–°",risk:20,label:"–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π"}]),j=a.useCallback((e,t)=>{m(t),e.length&&c(180===t?e:e.slice(-t))},[]);a.useEffect(()=>{const t=localStorage.getItem("user_region_id")||1;Promise.all([e.getRegionData(t),e.prefetch("/api/forecasts","short")]).then(([e,t])=>{if(e?.history){const t=(Array.isArray(e.history)?e.history:[]).map(e=>({...e,value:Number(e.value)||0,date:e.date||(new Date).toISOString()})).sort((e,t)=>new Date(e.date)-new Date(t.date));d(t),j(t,30)}Array.isArray(t)&&t.length>0&&p(t)}).catch(e=>{}).finally(()=>b(!1))},[j]);const k="dark"===o,N=a.useMemo(()=>n.length&&Number(n[n.length-1].value)||0,[n]),D=a.useMemo(()=>N>=9?{label:"üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô",color:"from-red-600 to-red-700",glow:"shadow-2xl shadow-red-500/50",textColor:"text-red-500"}:N>=7?{label:"üü† –í–´–°–û–ö–ò–ô",color:"from-orange-600 to-orange-700",glow:"shadow-2xl shadow-orange-500/50",textColor:"text-orange-500"}:N>=4?{label:"üü° –°–†–ï–î–ù–ò–ô",color:"from-yellow-600 to-yellow-700",glow:"shadow-2xl shadow-yellow-500/30",textColor:"text-yellow-500"}:{label:"üü¢ –ù–ò–ó–ö–ò–ô",color:"from-green-600 to-green-700",glow:"shadow-2xl shadow-green-500/30",textColor:"text-green-500"},[N]),C=a.useCallback(e=>e>=70?{bg:"from-red-500/20 to-red-600/10",border:"border-red-500/30",shadow:"shadow-lg shadow-red-500/30",bar:"bg-red-500",textClass:"text-red-400"}:e>=50?{bg:"from-orange-500/20 to-orange-600/10",border:"border-orange-500/30",shadow:"shadow-lg shadow-orange-500/30",bar:"bg-orange-500",textClass:"text-orange-400"}:e>=30?{bg:"from-yellow-500/20 to-yellow-600/10",border:"border-yellow-500/30",shadow:"shadow-lg shadow-yellow-500/20",bar:"bg-yellow-500",textClass:"text-yellow-400"}:{bg:"from-green-500/20 to-green-600/10",border:"border-green-500/30",shadow:"shadow-lg shadow-green-500/20",bar:"bg-green-500",textClass:"text-green-400"},[]);return h?t.jsx(w,{isBgDark:k}):t.jsxs(r.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-screen pt-16 pb-32 px-2.5 md:px-5 max-w-5xl mx-auto flex flex-col transition-colors duration-300 "+(k?"bg-black text-white":"bg-[#f2f2f7] text-black"),children:[t.jsxs(r.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-12",children:[t.jsx("h2",{className:"text-4xl md:text-5xl font-black tracking-tight mb-3",children:"–î–∏–Ω–∞–º–∏–∫–∞ –†–∏—Å–∫–∞"}),t.jsx("p",{className:"text-base md:text-lg font-medium "+(k?"text-gray-400":"text-gray-600"),children:"–ò–Ω–¥–µ–∫—Å —Ä–∏—Å–∫–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ ‚Ä¢ –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏"})]}),t.jsx(u,{riskLevel:D,lastVal:N,isBgDark:k}),t.jsx(y,{timeframe:x,onChange:e=>j(l,e),isBgDark:k}),t.jsx(v,{viewData:n,isBgDark:k}),t.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"rounded-[36px] p-8 md:p-10 backdrop-blur-3xl border shadow-2xl relative overflow-hidden "+(k?"bg-gradient-to-br from-white/8 via-white/5 to-white/3 border-white/15":"bg-gradient-to-br from-white/70 via-white/60 to-white/50 border-white/40"),children:[t.jsx("div",{className:"absolute inset-0 opacity-20 pointer-events-none rounded-[36px]",children:t.jsx("div",{className:"absolute top-0 right-0 w-72 h-72 rounded-full blur-3xl bg-gradient-to-l from-red-500 to-orange-400 opacity-40"})}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center gap-4 md:gap-5 mb-8",children:[t.jsx(r.div,{whileHover:{scale:1.05},className:"p-3 md:p-4 rounded-2xl bg-gradient-to-br from-red-500 to-orange-600 shadow-lg shadow-red-500/40 flex-shrink-0",children:t.jsx(i,{size:28,className:"text-white md:w-8 md:h-8"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-2xl md:text-3xl font-black",children:"–ü—Ä–æ–≥–Ω–æ–∑"}),t.jsx("p",{className:"text-sm mt-1 font-medium "+(k?"text-gray-400":"text-gray-600"),children:"–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –Ω–µ–¥–µ–ª—é"})]})]}),t.jsx("div",{className:"grid grid-cols-1 gap-2 md:gap-4 mb-6",children:g.map((e,a)=>t.jsx(f,{item:e,index:a,getRiskColor:C},e.day))}),t.jsxs(r.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"p-5 md:p-6 rounded-2xl flex gap-4 bg-gradient-to-br border backdrop-blur-xl "+(k?"from-yellow-900/20 to-orange-900/10 border-yellow-500/30 shadow-lg shadow-yellow-500/20":"from-yellow-400/20 to-orange-400/10 border-yellow-500/30 shadow-lg shadow-yellow-500/20"),children:[t.jsx(s,{size:20,className:"text-yellow-500 flex-shrink-0 mt-1 drop-shadow-lg md:w-6 md:h-6"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm md:text-base font-bold",children:"–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è"}),t.jsx("p",{className:"text-sm opacity-80 mt-2",children:"–í –¥–Ω–∏ –≤—ã—Å–æ–∫–æ–≥–æ —Ä–∏—Å–∫–∞ –∏–∑–±–µ–≥–∞–π—Ç–µ —Å–∫–æ–ø–ª–µ–Ω–∏—è –ª—é–¥–µ–π –∏ –æ—Å—Ç–∞–≤–∞–π—Ç–µ—Å—å –¥–æ–º–∞. –°–æ–±–ª—é–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏."})]})]})]})]})]})};export{j as default};
